# é¡¹ç›®æ¦‚è¿°
æœ¬é¡¹ç›®æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨Qdrantå’ŒMilvuså‘é‡æ•°æ®åº“ï¼ŒåŒ…å«æ•°æ®åŠ è½½ã€æŸ¥è¯¢æµ‹è¯•å’Œé…ç½®ç®¡ç†åŠŸèƒ½ã€‚

## å®‰è£…è¯´æ˜

### å®‰è£…Qdrantå®¢æˆ·ç«¯
```bash
conda activate myenv
pip3 install qdrant-client -i https://pypi.tuna.tsinghua.edu.cn/simple
```

**æ³¨æ„**ï¼š`myenv`æ˜¯ä½ è‡ªå·±çš„condaç¯å¢ƒ

## ğŸ“Š æ•°æ®é›†è¯´æ˜

### æ•°æ®é›†ç»Ÿè®¡ (ä½¿ç”¨Lâ‚‚è·ç¦»æˆ–å†…ç§¯è·ç¦»è¿›è¡Œåº¦é‡)

| æ•°æ®é›†åç§° | æ•°æ®è§„æ¨¡   | æ•°æ®ç»´åº¦ | åŸå§‹æ•°æ®ç±»å‹ | å…³ç³»å±æ€§ |
|:---------:|:----------:|:-------:|:----------:|:--------:|
| WIT        | 8,807   | 2048 | å›¾åƒ      | å›¾ç‰‡å°ºå¯¸ï¼ˆintç±»å‹ï¼‰  |
| Youtube-audio   | 71,321 | 128  | éŸ³é¢‘      | ç±»åˆ«æ ‡ç­¾ï¼ˆstringç±»å‹ï¼‰ |
| Youtube-rgb    | 31,406 | 1024 | è§†é¢‘      | åœºæ™¯åˆ†ç±»ï¼ˆstringç±»å‹ï¼‰ |

**å­—æ®µè¯¦ç»†è¯´æ˜**ï¼š

- **æ•°æ®è§„æ¨¡**ï¼šå‘é‡æ¡ç›®æ€»æ•°
- **æ•°æ®ç»´åº¦**ï¼šæ¯ä¸ªå‘é‡çš„ç»´åº¦æ•°
- **å…³ç³»å±æ€§**ï¼šå…³ç³»å±æ€§å‡åªåŒ…å«1ä¸ªç‰¹å¾

### æ•°æ®é›†åŸå§‹æ–‡ä»¶æ ¼å¼

- **query.txt**ï¼šå‘é‡æŸ¥è¯¢çš„æ–‡ä»¶
  - ç¬¬1è¡Œï¼šå‘é‡æŸ¥è¯¢æ•°é‡m å‘é‡æ•°æ®ç»´åº¦d
  - ç¬¬2~m+1è¡Œï¼šæŸ¥è¯¢å‘é‡ï¼ˆdä¸ªæµ®ç‚¹æ•°ï¼‰ å…³ç³»å±æ€§è¿‡æ»¤æ¡ä»¶
- **vector_0.fivecs**ï¼šå‘é‡æ•°æ®çš„æ–‡ä»¶ï¼ˆäºŒè¿›åˆ¶æ ¼å¼ï¼‰
- **meta_0.txt**ï¼šå‘é‡æ•°æ®æ‰€å¯¹åº”å…³ç³»å±æ€§çš„æ–‡ä»¶
  - ç¬¬1è¡Œï¼šå‘é‡æ•°é‡n å…³ç³»å±æ€§æ•°é‡cï¼ˆcå‡ä¸º1ï¼‰
  - ç¬¬2è¡Œï¼šå…³ç³»å±æ€§çš„åç§° å…³ç³»å±æ€§çš„ç±»å‹
  - ç¬¬3~n+2è¡Œï¼šå‘é‡æ•°æ®å¯¹åº”çš„å…³ç³»å±æ€§

## Milvuså‘é‡æ•°æ®åº“ç›¸å…³æ–‡ä»¶è¯´æ˜

### ä»£ç ç»“æ„
â”œâ”€â”€ README.md
â”œâ”€â”€ PlotFigure.py        # ç”»å®éªŒå›¾è„šæœ¬ï¼ˆoptionalï¼‰
â”œâ”€â”€ VdbConfig.py         # é…ç½®æ–‡ä»¶
â”œâ”€â”€ ListCollection.py    # æŸ¥è¯¢å½“å‰å‘é‡æ•°æ®åº“ä¸­çš„æ•°æ®é›†
â”œâ”€â”€ DataLoader.py        # åŠ è½½æ•°æ®åˆ°Milvuså‘é‡æ•°æ®åº“ä¸­
â””â”€â”€ QueryProcessor.py    # æµ‹è¯•Milvuså‘é‡æ•°æ®åº“çš„æŸ¥è¯¢æ€§èƒ½

### VdbConfig.py
**åŠŸèƒ½**ï¼šç»Ÿä¸€é…ç½®æ•°æ®é›†æ–‡ä»¶åœ°å€ï¼Œä¸»è¦åŒ…æ‹¬ï¼š
>* **DATASET_NAME**ï¼šæ•°æ®é›†ï¼ˆé›†åˆï¼‰åç§°
>* **DATASET_VECTOR_PATH**ï¼šåŸå§‹å‘é‡æ•°æ®çš„ç›®å½•
>* **DATASET_ATTR_PATH**ï¼šåŸå§‹å‘é‡æ•°æ®æ‰€å¯¹åº”å…³ç³»å±æ€§çš„ç›®å½•
>* **SCHEMA_FIELD_CONFIG**ï¼šæ•°æ®é›†çš„æ¨¡å¼é…ç½®
>* **INDEX_PARAMS**ï¼šå‘é‡ç´¢å¼•é…ç½®ï¼Œå…¶ä¸­FLATå‘é‡ç´¢å¼•ç”¨äºè®¡ç®—Ground Truth
>* **QUERY_WORKLOAD**: å¾…æµ‹è¯•å‘é‡æŸ¥è¯¢çš„ç›®å½•
>* **SEARCH_PARAMS**: å‘é‡æŸ¥è¯¢å¤„ç†è¿‡ç¨‹ä¸­çš„å‚æ•°è®¾ç½®

**æ³¨æ„**ï¼šåœ¨``SCHEMA_FIELD_CONFIG``ä¸­ï¼Œå‘é‡æ•°æ®çš„``dim``å±æ€§éœ€è¦æ ¹æ®æ•°æ®é›†è¿›è¡ŒåŠ¨æ€è°ƒæ•´


### DataLoader.py
**åŠŸèƒ½**ï¼šå°†æ•°æ®é›†åŠ è½½åˆ°Milvuså‘é‡æ•°æ®åº“ï¼Œä¸»è¦åŒ…æ‹¬ï¼š
>* æ£€æŸ¥å¹¶åˆ›å»ºé›†åˆ
>* æ‰¹é‡æ’å…¥å‘é‡æ•°æ®
>* æ„å»ºå‘é‡ç´¢å¼•

**è¿è¡Œ**ï¼š
```bash
python3 DataLoader.py
```

### QueryProcessor.py
**åŠŸèƒ½**ï¼šæµ‹è¯•Milvuså‘é‡æ•°æ®åº“çš„æŸ¥è¯¢æ€§èƒ½
>* KNNæŸ¥è¯¢
>* æ··åˆæŸ¥è¯¢
>* å¬å›ç‡è®¡ç®—

**è¿è¡Œ**ï¼š
```bash
python3 QueryProcessor.py
```

## Qdrantå‘é‡æ•°æ®åº“ç›¸å…³æ–‡ä»¶è¯´æ˜ 

### TestQdrant.py
**åŠŸèƒ½**ï¼šQdrantå‘é‡æ•°æ®åº“çš„åŸºæœ¬æ“ä½œï¼Œä¸»è¦åŒ…æ‹¬ï¼š
>* æ•°æ®é›†ï¼ˆé›†åˆï¼‰çš„åˆ›å»ºä¸åˆ é™¤
>* å‘é‡æ•°æ®çš„è£…è½½
>* KNNæŸ¥è¯¢
>* æ··åˆæŸ¥è¯¢
>* æŸ¥è¯¢ç»“æœæ‰“å°

**è¿è¡Œ**ï¼š
```bash
python3 TestQdrant.py
```