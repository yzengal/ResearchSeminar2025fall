# é¡¹ç›®æ¦‚è¿°
æœ¬é¡¹ç›®æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨Milvuså‘é‡æ•°æ®åº“å®ç°å¤šå‘é‡æŸ¥è¯¢ï¼ˆMulti-Vector Searchï¼‰ã€‚

## ğŸ“Š æ•°æ®é›†è¯´æ˜

### æ•°æ®é›†ç»Ÿè®¡ (ä½¿ç”¨Lâ‚‚è·ç¦»æˆ–å†…ç§¯è·ç¦»è¿›è¡Œåº¦é‡)

| æ•°æ®é›†åç§° | å‘é‡æ•°æ®è§„æ¨¡   | å‘é‡æ•°æ®ç»´åº¦ | åŸå§‹æ•°æ®ç±»å‹ | å…³ç³»å±æ€§ |
|:---------:|:----------:|:-------:|:----------:|:--------:|
| LoTTE (data) | 190,162   | 128 | æ–‡æœ¬æ®µï¼ˆè‹±æ–‡ï¼‰ | æ–‡æœ¬æ®µè½ID (0~999)  |
| LoTTE (query) | 3,200   | 128 | æ–‡æœ¬æ®µï¼ˆè‹±æ–‡ï¼‰ | æŸ¥è¯¢å‘é‡ID (0~99)  |

**å­—æ®µè¯¦ç»†è¯´æ˜**ï¼š

- **å‘é‡æ•°æ®è§„æ¨¡**ï¼šæŸ¥è¯¢å‘é‡çš„æ¡ç›®æ€»æ•°
- **å‘é‡æ•°æ®ç»´åº¦**ï¼šæ¯ä¸ªæŸ¥è¯¢å‘é‡çš„ç»´åº¦æ•°
- **å…³ç³»å±æ€§**ï¼šæ¯ä¸ªæŸ¥è¯¢æ®µè½æ˜ å°„ä¸ºå¤šä¸ªå‘é‡

### æ•°æ®é›†åŸå§‹æ–‡ä»¶æ ¼å¼

- **lotte-lifestyle-data-small.fivecs**ï¼šFileIO.pyä¸­çš„read_fivecsè¯»å–æ•°æ®æ–‡ä»¶
  - è¾“å‡ºç»“æœæ ¼å¼ï¼š[[vector_id, doc_id, embedding], ...]
  - æ¯ä¸ªæ–‡æœ¬å¯èƒ½åŒ…å«ä¸åŒæ•°é‡ä¸ªå‘é‡
- **lotte-lifestyle-query-small.fivecs**ï¼šFileIO.pyä¸­çš„read_fivecsè¯»å–æŸ¥è¯¢æ–‡ä»¶
  - è¾“å‡ºç»“æœæ ¼å¼ï¼š[[vector_id, query_id, embedding], ...]
  - æ¯ä¸ªQueryåŒ…å«32ä¸ªå‘é‡
- **ground_truth.dat**ï¼šå‘é‡æŸ¥è¯¢çš„ç²¾ç¡®ç»“æœæ–‡ä»¶ï¼ˆå¯è¯»ï¼‰
  - ç¬¬1è¡Œï¼šå‘é‡æŸ¥è¯¢æ•°é‡m
  - ç¬¬2~m+1è¡Œï¼š[doc_id, ...] # æ¯ä¸ªæŸ¥è¯¢å‘é‡çš„20NN

## Milvuså‘é‡æ•°æ®åº“ç›¸å…³æ–‡ä»¶è¯´æ˜

### ä»£ç ç»“æ„
â”œâ”€â”€ README.md
â”œâ”€â”€ FileIO.py            # è¯»å–åŸå§‹æ•°æ®æ–‡ä»¶
â”œâ”€â”€ VdbConfig.py         # é…ç½®æ–‡ä»¶
â”œâ”€â”€ ListCollection.py    # æŸ¥è¯¢å½“å‰å‘é‡æ•°æ®åº“ä¸­çš„æ•°æ®é›†
â”œâ”€â”€ DataLoader.py        # åŠ è½½æ•°æ®åˆ°Milvuså‘é‡æ•°æ®åº“ä¸­
â””â”€â”€ MultiVectorSearch.py        # ä½¿ç”¨Milvuså‘é‡æ•°æ®åº“çš„å®ç°å¤šå‘é‡æœç´¢

### VdbConfig.py
**åŠŸèƒ½**ï¼šç»Ÿä¸€é…ç½®æ•°æ®é›†æ–‡ä»¶åœ°å€ï¼Œä¸»è¦åŒ…æ‹¬ï¼š
>* **DATASET_NAME**ï¼šæ•°æ®é›†ï¼ˆé›†åˆï¼‰åç§°
>* **DATASET_VECTOR_PATH**ï¼šåŸå§‹å‘é‡æ•°æ®çš„ç›®å½•
>* **DATASET_ATTR_PATH**ï¼šåŸå§‹å‘é‡æ•°æ®æ‰€å¯¹åº”å…³ç³»å±æ€§çš„ç›®å½•
>* **SCHEMA_FIELD_CONFIG**ï¼šæ•°æ®é›†çš„æ¨¡å¼é…ç½®
>* **INDEX_PARAMS**ï¼šå‘é‡ç´¢å¼•é…ç½®ï¼Œå…¶ä¸­FLATå‘é‡ç´¢å¼•ç”¨äºè®¡ç®—Ground Truth
>* **QUERY_WORKLOAD**: å¾…æµ‹è¯•å‘é‡æŸ¥è¯¢çš„ç›®å½•
>* **SEARCH_PARAMS**: å‘é‡æŸ¥è¯¢å¤„ç†è¿‡ç¨‹ä¸­çš„å‚æ•°è®¾ç½®

**æ³¨æ„**ï¼šåœ¨``SCHEMA_FIELD_CONFIG``ä¸­ï¼Œå‘é‡æ•°æ®çš„``dim``å±æ€§éœ€è¦æ ¹æ®æ•°æ®é›†è¿›è¡ŒåŠ¨æ€è°ƒæ•´

### DataLoader.py
**åŠŸèƒ½**ï¼šå°†æ•°æ®é›†åŠ è½½åˆ°Milvuså‘é‡æ•°æ®åº“ï¼Œä¸»è¦åŒ…æ‹¬ï¼š
>* æ£€æŸ¥å¹¶åˆ›å»ºé›†åˆ
>* æ‰¹é‡æ’å…¥å‘é‡æ•°æ®
>* æ„å»ºå‘é‡ç´¢å¼•

**è¿è¡Œ**ï¼š
```bash
python3 DataLoader.py
```

### MultiVectorSearch.py
**åŠŸèƒ½**ï¼šä½¿ç”¨Milvuså‘é‡æ•°æ®åº“å®ç°å¤šå‘é‡æœç´¢
>* KNNæŸ¥è¯¢
>* æ··åˆæŸ¥è¯¢
>* å¬å›ç‡è®¡ç®—

**è¿è¡Œ**ï¼š
```bash
python3 MultiVectorSearch.py
```
